<button class='newReservationButton' (click)='showNewReservation()'>
    +
</button>


<div id='reservationForm'>
    <form>
        From: <input type='date' class='form-control' [(ngModel)]="dateFrom" name="dateFrom">
        To: <input type='date' class='form-control' [(ngModel)]="dateTo" name="dateTo">
        Room: 
        <select [(ngModel)]="roomSelectedId" class='form-control' name="roomSelectedId">
            <option *ngFor='let room of rooms'>
                {{ room.id }}
            </option>
        </select>
        Name: <input class='form-control' type='text' [(ngModel)]="name" name="name">
        Email: <input class='form-control' type='text' [(ngModel)]="email" name="email">
        Phone: <input class='form-control' type='text' [(ngModel)]="phone" name="phone">
        Notes: <textarea class='form-control' [(ngModel)]="notes" name="notes"></textarea> <br>
        <input class='form-control' type='button' value='Book' (click)='book()'>
    </form>
</div>



<div class="content-container">

    <div id='msg-popup' class='hide'> {{ message }} </div>


    <div style='display:inline-block; align-items: center;margin-bottom: 30px;'>
        <span style='margin-left:20px'>Calendar View</span>
        <!-- Rounded switch -->
        <label class="switch" style='margin-left:10px; margin-bottom: 0;'>
            <input type="checkbox" [(ngModel)]="calendarView" name="calendarView"> 
            <span class="slider round"></span>
        </label>
    
    </div>

    <div style='display:flex; align-items: center; position:relative; float:right; margin-right: 30px;'>
        <input type='text' class='form-control' 
        style='background: url(../../../assets/styles/images/icons/search.png) no-repeat scroll 7px 7px; padding-left: 50px;'>
    </div>
    

    <div style="width: 200px; margin-left: 30px">
        <select class='form-control'  [(ngModel)]="curMonth" class='form-control' name="curMonth" (change)="changeMonth($event.target.value)">
            <option *ngFor='let month of months'>
                {{ month }}
            </option>
        </select>
      </div>

    <div class="container" *ngIf='!calendarView'>
        <h2>Reservations</h2>
        <ul class="responsive-table" style='padding:0'>
          <li class="table-header">
            <div class="col">Name</div>
            <div class="col">Date from</div>
            <div class="col">Date to</div>
            <div class="col">Room Number</div>
            <div class="col">Paid</div>
            <div class="col">Reserved</div>
            <div class="col"></div>
          </li>
          <li class="table-row" *ngFor='let reservation of reservations; index as i'>
            <div class="col" data-label="Name">
                <span *ngIf="!editMode[i]">{{ reservation.person.name }}</span>
                <input *ngIf="editMode[i]" [(ngModel)]="reservation.person.name" name="personName">
            </div>
            <div class="col" data-label="Date from">
                <span *ngIf="!editMode[i]">{{ formattedDate(reservation.date_from) }}</span>
                <input type="date" class='form-control' *ngIf="editMode[i]" [(ngModel)]="reservation.date_from" name="resDateFrom">
            </div>
            <div class="col" data-label="Date to">{{ formattedDate(reservation.date_to) }}</div>
            <div class="col" data-label="Room">{{ reservation.room }}</div>
            <div class="col" data-label="Paid">{{ reservation.payed }}</div>
            <div class="col" data-label="Reserved">{{ formattedDateTime(reservation.timestamp) }}</div>
            <div class="col" data-label="Edit">
                <img src="../../../assets/styles/images/edit.png" (click)="editMode[i] = true" *ngIf="!editMode[i]">
                <img src="../../../assets/styles/images/check.png" (click)="updateRes(i)" *ngIf="editMode[i]">
                <img src="../../../assets/styles/images/trash.png" (click)="deleteRes(reservation.id)">
            </div>
          </li>
        </ul>
      </div>


      <div *ngIf='calendarView' style='margin: 20px'>
        <table width='100%' class='calendarView'>
            <tr>
                <td></td>
                <td *ngFor='let room of rooms'>{{ room.id }}</td>
            </tr>
            <tr *ngFor = 'let date of dates'>
                <td>
                    {{ date.getDate() }}
                </td>
                <td *ngFor = 'let room of rooms' [attr.id]="'Reservation ' + date.getDate() +'-' + room.id" style="width:5%">
                    {{ getReservation(date, room.id) }}
                </td>
            </tr>
        </table>
      </div>

</div>
